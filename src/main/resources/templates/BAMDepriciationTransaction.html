<!DOCTYPE html SYSTEM "http://www.thymeleaf.org/dtd/xhtml1-strict-thymeleaf-4.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
	xmlns:th="http://www.thymeleaf.org">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css"
	href="/webjars/bootstrap/4.3.1/css/bootstrap.min.css"
	th:href="@{/webjars/bootstrap/4.3.1/css/bootstrap.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/font-awesome/5.9.0/css/all.min.css"
	th:href="@{/webjars/font-awesome/5.9.0/css/all.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/jquery-ui/1.12.1/jquery-ui.min.css"
	th:href="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.css}">
<link rel="stylesheet" type="text/css"
	href="/webjars/datatables/1.10.19/css/jquery.dataTables.min.css"
	th:href="@{/webjars/datatables/1.10.19/css/jquery.dataTables.min.css}">
<link rel="shortcut icon" th:href="@{/favicon.ico}" type="image/x-icon">
<link rel="icon" th:href="@{/favicon.ico}" type="image/x-icon">
<link th:href="@{/css/bootstrap.min.css}" rel="stylesheet"
	type="text/css">

<script src="/webjars/bootstrap/4.3.1/js/bootstrap.min.js"
	th:src="@{/webjars/bootstrap/4.3.1/js/bootstrap.min.js}"></script>
<script src="/webjars/popper.js/1.14.7/umd/popper.min.js"
	th:src="@{/webjars/popper.js/1.14.7/umd/popper.min.js}"></script>
<script src="/webjars/jquery/3.4.1/jquery.min.js"
	th:src="@{/webjars/jquery/3.4.1/jquery.min.js}"></script>
<script src="/webjars/jquery-ui/1.12.1/jquery-ui.min.js"
	th:src="@{/webjars/jquery-ui/1.12.1/jquery-ui.min.js}"></script>
<script src="/webjars/jquery-form/4.2.2/jquery.form.min.js"
	th:src="@{/webjars/jquery-form/4.2.2/jquery.form.min.js}"></script>
<script src="/webjars/jquery-validation/1.19.0/jquery.validate.min.js"
	th:src="@{/webjars/jquery-validation/1.19.0/jquery.validate.min.js}"></script>
<script src="/webjars/datatables/1.10.19/js/jquery.dataTables.min.js"
	th:src="@{/webjars/datatables/1.10.19/js/jquery.dataTables.min.js}"></script>
<script
	src="/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js"
	th:src="@{/webjars/datatables/1.10.19/js/dataTables.bootstrap4.min.js}"></script>

<style>
	
	body {
			  overflow-y: hidden;
			}
.no-border-table {
	border: none;
	border-collapse: collapse;
}

.no-border-table td {
	border: none;
}

.btns {
	float: right;
	margin: 5px;
}

.col-sm-5 {
	padding-bottom: 15px;
}

.list-body {
	padding: 0px;
}

.error {
	color: red;
	padding-left: 10px;
}

.formline {
	padding-bottom: 4px;
}

#finusertb {
	width: 460px;
}

.dataTables_wrapper .dataTables_paginate .paginate_button {
	padding: 0px;
}

.nav-tabs .nav-item.show .nav-link, .nav-tabs .nav-link.active {
	border: 2px solid skyblue !important;
	border-bottom: unset !important;
	background-color: unset !important;
	color: black !important;
	background-color: unset !important;
}

nav {
	border-bottom: 2px solid grey;
}

fieldset {
	border: 1px solid #CCC;
	border-radius: 5px;
	padding: 10px;
	margin-top: 10px;
}

legend {
	color: #3C6EAC;
	font-size: 20px;
	font-weight: bold !important;
	text-align: left !important;
	border-bottom: none;
}

.filterable .filters input[readonly] {
	background-color: transparent;
	border: none;
	cursor: auto;
	box-shadow: none;
	padding: 0;
	height: auto;
}

.filterable .filters input[readonly]::-webkit-input-placeholder {
	color: #333;
}

.filterable .filters input[readonly]::-moz-placeholder {
	color: #333;
}

.filterable .filters input[readonly]:-ms-input-placeholder {
	color: #333;
}

.form-group {
	display: flex;
	justify-content: space-between;
	margin-bottom: 15px;
}

.form-group label, .form-group input, .form-group select {
	flex: 1;
	margin-right: 10px;
}

.form-group input, .form-group select {
	padding: 5px;
	flex: 2;
}

.container {
	width: 100%;
	margin: 0 auto;
	background-color: #ffffff;
	padding: 20px;
	box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
	border-radius: 8px;
}

.red-border {
	border: 1px solid black;
	padding: 10px;
	margin-top: 20px;
	color: #A52A2A;
}

.red-border div {
	display: flex;
	justify-content: space-between;
}
</style>
<script th:inline="javascript">
	/*<![CDATA[*/
	//DatePicker
	$(function() {

		$("#startDate,#endDate,#proposalDate").datepicker({

			changeMonth : true,
			changeYear : true,
			dateFormat : "dd-mm-yy"
		});
	});

	function home() {
		location.href = 'Dashboard'
	}

	function back() {
		window.history.back();
	}

	function adduser() {
		location.href = 'mtWorkAssignment?formmode=add';
	}

	function ListUser() {
		location.href = 'mtWorkAssignment?formmode=list';
	}

	function modifyUser() {
		location.href = 'mtWorkAssignment?formmode=list1';
	}

	function groupDropdown(a) {
		$("#hideGroup").hide();
		$("#showGroup").show();
	}

	function teamDropdown(a) {
		$("#hideTeam").hide();
		$("#showTeam").show();
	}

	$(document).ready(
			function() {
				$(".checkToView").on(
						'click',
						function() {

							$(this).prop('checked', true);

							var tranid = $(this).val();

							var formmode = "view";

							location.href = 'DepreciationTransaction?formmode='
									+ formmode + '&tranid=' + tranid;

						});
			});

	//Filter Table

	$(document)
			.ready(
					function() {
						$('.filterable .btn-filter')
								.click(
										function(event) {
											event.preventDefault();
											var $panel = $(this).parents(
													'.filterable'), $filters = $panel
													.find('.filters input'), $tbody = $panel
													.find('.table tbody');
											if ($filters.prop('readonly') == true) {
												$filters
														.prop('readonly', false);
												$filters.first().focus();
											} else {
												$filters.val('').prop(
														'readonly', true);
												$tbody.find('.no-result')
														.remove();
												$tbody.find('tr').show();
											}
										});

						$('.filterable .filters input')
								.keyup(
										function(e) {
											/* Ignore tab key */
											var code = e.keyCode || e.which;
											if (code == '9')
												return;
											/* Useful DOM data and selectors */
											var $input = $(this), inputContent = $input
													.val().toLowerCase(), $panel = $input
													.parents('.filterable'), column = $panel
													.find('.filters th')
													.index($input.parents('th')), $table = $panel
													.find('.table'), $rows = $table
													.find('tbody tr');
											/* Dirtiest filter function ever ;) */
											var $filteredRows = $rows
													.filter(function() {
														var value = $(this)
																.find('td').eq(
																		column)
																.text()
																.toLowerCase();
														return value
																.indexOf(inputContent) === -1;
													});
											/* Clean previous no-result if exist */
											$table.find('tbody .no-result')
													.remove();
											/* Show all rows, hide filtered ones (never do that outside of a demo ! xD) */
											$rows.show();
											$filteredRows.hide();
											/* Prepend no-result row if all rows are filtered */
											if ($filteredRows.length === $rows.length) {
												$table
														.find('tbody')
														.prepend(
																$('<tr class="no-result text-center"><td colspan="'
																		+ $table
																				.find('.filters th').length
																		+ '">No result found</td></tr>'));
											}
										});
					});
</script>

</head>
<title>BAM</title>

<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-sm-2">
				<div th:insert="BTMHeaderMenu :: header"></div>
			</div>
			<div class="col-sm-10">

				<div class="container-fluid"
					th:if="${formmode}=='list' OR ${formmode}=='list1'">
					<div class="row">
						<div class="col-sm-12">
							<div class="container-fluid content">
								<div class="row">
									<div class="card w-100">

										<div class="card-body p-0">

											<div class="panel panel-primary filterable ">
												<div class="card-header d-flex justify-content-between p-1">
													<h4 class="headerbutton p-2">DEPRECIATION TRANSACTION
														LIST</h4>
													<button class="btn text-white  btn-filter headerbutton">Filter</button>
												</div>

												<div class="table-responsive"
													style="overflow-y: auto; height: 85vh; border: 1px solid #dee2e6;">
													<table class="table bordered table-bordered">
														<thead
															style="position: sticky; top: 0; background-color: #f8f9fa; z-index: 1;">
															<tr class="filters">
																<th><input type="text"
																	class="form-control font-weight-bold"
																	placeholder="Asset srl No" readonly></th>
																<th><input type="text"
																	class="form-control font-weight-bold"
																	placeholder="Asset Name" readonly></th>
																<th><input type="text"
																	class="form-control font-weight-bold"
																	placeholder="Original Cost" readonly></th>
																<th><input type="text"
																	class="form-control font-weight-bold"
																	placeholder="Depreciation percentage" readonly></th>
																<th><input type="text" style="width: 200px;"
																	class="form-control font-weight-bold"
																	placeholder="Depreciation method" readonly></th>
																<th><input type="text" style="width: 200px;"
																	class="form-control font-weight-bold"
																	placeholder="Tran ID" readonly></th>
																<th><input type="text" style="width: 200px;"
																	class="form-control font-weight-bold"
																	placeholder="Tran Date" readonly></th>
																<th>Select</th>
															</tr>
														</thead>

														<tbody>
															<!--  <tr th:each="workAssignment: ${WorkAssignmentList}">
																<td th:text="${workAssignment?.emp_id}"></td>
																<td th:text="${workAssignment?.emp_name}"></td>
																<td th:text="${workAssignment?.emp_group}"></td>
																<td th:text="${workAssignment?.emp_team}"></td>
																<td
																	th:text="${#dates.format(workAssignment?.start_date,'dd-MM-yyyy')}"></td>
																<td th:text="${workAssignment?.cur_assignment}"></td>
																<td th:text="${workAssignment?.work_detail}"></td>
																<td
																	th:text="${#dates.format(workAssignment?.end_date,'dd-MM-yyyy')}"></td>
																<td th:text="${workAssignment?.status}"></td>
																<td><input th:if="${formmode}=='list1'"
																	class="form-control-md checkToModify"
																	th:value="${workAssignment?.srl_no}" type="radio" /></td>

																<td><input th:if="${formmode}=='list'"
																	class="form-control-md checkToView"
																	th:value="${workAssignment?.srl_no}" type="radio" /></td>
															</tr>-->
															<tr th:each="gettran: ${gettran}">
																<td th:text="${gettran?.asset_serial_no}"></td>
																<td th:text="${gettran?.asset_name}"></td>
																<td class="org_cost" th:text="${gettran?.original_cost}" align="right"></td>
																<td th:text="${gettran?.depreciation_percentage}"></td>
																<td th:text="${gettran?.depreciation_method}"></td>
																<td th:text="${gettran?.gen_tran_id}"></td>
																<td
																	th:text="${#dates.format(gettran?.gen_tran_date,'dd-MM-yyyy')}"></td>

																<td><input th:if="${formmode}=='list'"
																	class="form-control-md checkToView"
																	th:value="${gettran?.gen_tran_id}" type="radio" /></td>
															</tr>

														</tbody>
													</table>
												</div>
											</div>
										</div>

										<div class="card-footer text-center p-0">
											<button type="button" class="btn headerbutton" id="btnHome"
												onclick="home();">Home</button>

											<button type="button" class="btn headerbutton" id="btnBack"
												onclick="back();">Back</button>
										</div>
									</div>

								</div>
							</div>
						</div>
					</div>
				</div>

				<div class="container-fluid content" th:if="${formmode}=='view'">
					<div class="row">
						<div class="col-sm-12 finuserapply">
							<form action="#" th:object="${gettranview}" method="POST"
								class="w-100" autocomplete="off" id="mtWorkAssignment">
								<div class="card">
									<div class="card-header">
										<div class="float-left">
											<h3 th:if="${formmode}=='view'">Depreciation Transaction</h3>
										</div>
									</div>
									<div class="card-body">
										<div class="row formline">
											<div class="col-sm-2">
												<label for="Assno">Asset Serial Number</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="Assno" th:if="${formmode}=='view'"
													th:value="${gettranview?.asset_serial_no}"
													class="form-control form-control-sm" readonly>
											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="employeeName">Asset Name</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="employeeName"
													th:if="${formmode}=='view'"
													class="form-control form-control-sm"
													th:value="${gettranview?.asset_name}" readonly />
											</div>
										</div>



										<div class="row formline">
											<div class="col-sm-2">
												<label for="designation">Asset Type</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="employeeName"
													th:if="${formmode}=='view'"
													class="form-control form-control-sm"
													th:value="${gettranview?.asset_type}" readonly />
											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="dob">Original Cost</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="employeeName"
													th:value="${gettranview?.original_cost}"
													class="form-control form-control-sm" readonly />
											</div>
										</div>



										<div class="row formline">
											<div class="col-sm-2">
												<label for="designation">Asset Currency</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="employeeName"
													th:value="${gettranview?.asset_currency}"
													class="form-control form-control-sm" readonly />

											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="dob">Accumulated Depreciation</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													th:value="${gettranview?.accum_depres}"
													class="form-control form-control-sm" readonly />
											</div>
										</div>






										<div class="row formline">
											<div class="col-sm-2">
												<label for="designation">Date of Purchase</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													th:if="${formmode}=='view'"
													th:value="${#dates.format(gettranview?.date_of_purchase,'dd-MM-yyyy')}"
													class="form-control form-control-sm" readonly />
											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="dob">Year of Purchase</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													th:if="${formmode}=='view'"
													th:value="${gettranview?.year_of_purchase}"
													class="form-control form-control-sm" readonly />

											</div>
										</div>


										<div class="row formline">
											<div class="col-sm-2">
												<label for="designation">Current Book value</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													class="form-control form-control-sm"
													th:if="${formmode}=='view'"
													th:value="${gettranview?.curr_book_value}" readonly />
											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="dob">Asset Expiry Date</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													class="form-control form-control-sm"
													th:if="${formmode}=='view'"
													th:value="${#dates.format(gettranview?.asst_exp_date,'dd-MM-yyyy')}"
													readonly />
											</div>
										</div>




										<div class="row formline">
											<div class="col-sm-2">
												<label for="designation">Depreciation Flag</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													class="form-control form-control-sm"
													th:if="${formmode}=='view'"
													th:value="${gettranview?.depreciation_flg}" readonly />

											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="dob">Depreciation Percentage</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													class="form-control form-control-sm"
													th:if="${formmode}=='view'"
													th:value="${gettranview?.depreciation_percentage}" readonly />
											</div>
										</div>


										<div class="row formline">
											<div class="col-sm-2">
												<label for="designation">Depreciation Method</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													class="form-control form-control-sm"
													th:if="${formmode}=='view'"
													th:value="${gettranview?.depreciation_method}" readonly />
											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="dob">Date of Last Depreciation</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													class="form-control form-control-sm"
													th:value="${#dates.format(gettranview?.date_of_last_depreciation,'dd-MM-yyyy')}"
													readonly />
											</div>
										</div>



										<div class="row formline">
											<div class="col-sm-2">
												<label for="designation">Depreciation Frequency</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													th:if="${formmode}=='view'"
													th:value="${gettranview?.depreciation_frequency}"
													class="form-control form-control-sm" readonly />
											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="dob">Date of Acquisition</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													th:if="${formmode}=='view'"
													class="form-control form-control-sm"
													th:value="${#dates.format(gettranview?.acquis_date,'dd-MM-yyyy')}"
													readonly />
											</div>
										</div>


										<div class="row formline">
											<div class="col-sm-2">
												<label for="designation">TRAN ID</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													th:if="${formmode}=='view'"
													class="form-control form-control-sm"
													th:value="${gettranview?.gen_tran_id}" readonly />
											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="dob">TRAN DATE</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													class="form-control form-control-sm"
													th:if="${formmode}=='view'"
													th:value="${gettranview?.gen_tran_id}" readonly />
											</div>
										</div>


										<div class="row formline">
											<div class="col-sm-2">
												<label for="designation">AMOUNT</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													class="form-control form-control-sm"
													th:value="${gettranview?.gen_amount}" readonly />
											</div>

											<div class="col-sm-2"></div>
											<div class="col-sm-2">
												<label for="dob">REMARKS</label>
											</div>
											<div class="col-sm-2">
												<input type="text" id="designation"
													class="form-control form-control-sm"
													th:value="${gettranview?.gen_remarks}" readonly />
											</div>

										</div>










									</div>





									<div class="card-footer text-center">

										<button type="button" class="btn headerbutton" id="btnHome"
											onclick="home()">Home</button>

										<button type="button" class="btn headerbutton" id="btnBack"
											onclick="back()">Back</button>

									</div>


									<!-- Conditionally display the table based on formmode  view-->
									<div class="table-responsive" th:object="${gettranview1}"
										th:if="${formmode}=='edit' OR ${formmode}=='verify' OR ${formmode}=='list' OR ${formmode}=='add'OR ${formmode}=='view' ">
								
											<div class="content m-2 " style="padding: 15px;">
										<div class="row formline">
											<label class="col-sm-2">Entry User</label>
											<div class="col-sm-2">
												<input type="text" id="entry_user" name="entry_user"
												th:value="${gettranview1?.entry_user}"
													class="form-control form-control-sm" autocomplete="off" readonly />
											</div>
											<label class="col-sm-2">Modify User</label>
											<div class="col-sm-2">
												<input type="text" id="modify_user" name="modify_user"
												th:value="${gettranview1?.modify_user}"
													class="form-control form-control-sm" autocomplete="off" readonly />
											</div>
											<label class="col-sm-2">Verify User</label>
											<div class="col-sm-2">
												<input type="text" id="auth_user" name="auth_user"
												th:value="${gettranview1?.verify_user}"
													class="form-control form-control-sm" autocomplete="off" readonly />
											</div>
										</div>
										<div class="row formline mt-2">
											<label class="col-sm-2">Entry Time</label>
											<div class="col-sm-2">
												<input type="text" id="entry_date" name="entry_time" th:value="${gettranview1?.entry_time}"
													class="form-control form-control-sm" autocomplete="off" readonly />
											</div>
											<label class="col-sm-2">Modify Time</label>
											<div class="col-sm-2">
												<input type="text" id="modify_time" name="modify_time" th:value="${gettranview1?.modify_time}"
													class="form-control form-control-sm" autocomplete="off" readonly />
											</div>
											<label class="col-sm-2">Verify Time</label>
											<div class="col-sm-2">
												<input type="text" id="auth_time" name="auth_time" th:value="${gettranview1?.verify_time}"
													class="form-control form-control-sm" autocomplete="off" readonly />
											</div>
										</div>
									</div>
										
									</div>

								</div>
							</form>





						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
<script>
document.addEventListener("DOMContentLoaded", function () {
	// Format all cells with class "cur-book-value"
	const curBookValues = document.querySelectorAll('.org_cost');
	curBookValues.forEach(cell => {
		formatTableValue(cell);
	});

	// Format all cells with class "mkt-value"
	const mktValues = document.querySelectorAll('.mkt_value');
	mktValues.forEach(cell => {
		formatTableValue(cell);
	});
});

function formatTableValue(element) {
	if (element && element.innerText) {
		let amount = element.innerText.replace(/,/g, ''); // Remove existing commas

		if (isNaN(amount) || amount === '') {
			return; // Return if the value is not a number or is empty
		}

		let formattedAmount = '';
		let afterDecimal = '';

		// Split integer and decimal parts
		if (amount.includes('.')) {
			[amount, afterDecimal] = amount.split('.');
			afterDecimal = '.' + afterDecimal;
		}

		// Format the integer part using the Indian system
		let lastThree = amount.slice(-3);
		let otherNumbers = amount.slice(0, -3);

		if (otherNumbers !== '') {
			// Add commas for every two digits in the part before the last three digits
			formattedAmount = otherNumbers.replace(/\B(?=(\d{2})+(?!\d))/g, ",") + ',' + lastThree;
		} else {
			formattedAmount = lastThree;
		}

		// Set the formatted value back to the element
		element.innerText = formattedAmount + afterDecimal;
	}
}

</script>


</body>
</html>